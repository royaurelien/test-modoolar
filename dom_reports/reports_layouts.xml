<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- <template id="assets_backend" name="yz_widgets_assets" inherit_id="web.assets_backend"> -->
    <template id="dom_reports_reports_assets_common" name="yz_widgets_assets" inherit_id="web.report_assets_common">
        <xpath expr="." position="inside">
            <link rel="stylesheet" href="/dom_reports/static/src/css/reports.css"/>
        </xpath>
    </template>

    <!-- layout -->
    <template id="dom_reports.external_layout_background">
        <div class="header">

            <t t-if="not bl">
                <div class="row">
                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % to_text(company.logo)" class="pull-left" width="410"/>
                </div>
            </t>

            <div class="row">
                <div class="col-xs-6">
                    <table class="header-table table-curved">
                        <thead>
                            <tr>
                                <th>date</th>
                                <th>
                                    <span t-if="cf">fournisseur</span>
                                    <span t-else="">client</span>
                                </th>
                                <th>page</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <!-- it's a datetime, so t-field auto formats with the hour. changing this here -->
                                    <span t-if="devis" t-field="doc.date_order"
                                        t-field-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }" />
                                    <span t-elif="bdc" t-field="doc.confirmation_date"
                                        t-field-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }" />
                                    <span t-elif="facture" t-field="doc.date_invoice"
                                        t-field-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }" />
                                    <span t-elif="bl" t-field="doc.scheduled_date"
                                        t-field-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }" />
                                    <span t-elif="cf" t-field="doc.date_order"
                                        t-field-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }" />
                                    <!-- <span t-else=""> <span t-field="doc.name" /> </span> -->
                                </td>
                                <td>
                                    <t t-if="bl">
                                        <t t-if="not doc.partner_id.ref">
                                            <span t-field="doc.partner_id.parent_id.ref" />
                                        </t>
                                        <t t-else="">
                                            <span t-field="doc.partner_id.ref" />
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <span t-field="doc.partner_id.ref" />
                                    </t>
                                </td>
                                <td> <span class="page" /> / <span class="topage" /> </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="col-xs-6">
                    <div class="header-cartouche">
                        <span t-if="devis"> Devis </span>
                        <span t-elif="bdc"> Bon de commande </span>
                        <span t-elif="facture"> Facture </span>
                        <span t-elif="bl"> Bon de livraison </span>
                        <span t-elif="cf"> Commande </span>
                        N° :&#xA0;
                        <t t-if="devis or bdc or bl or cf">
                            <span t-esc="doc.name" />
                        </t>
                        <t t-elif="facture">
                            <t t-if="doc.state in ['draft']">
                                facture en brouillon
                            </t>
                            <t t-else="">
                                <span t-esc="doc.number" />
                            </t>
                        </t>
                    </div>
                </div>

            </div>

        </div> <!-- end of header div -->

        <div class="article">
            <t t-raw="0"/>
        </div>

        <!-- footer -->
        <div t-if="not bl" class="footer">
            <div class="text-center" style="font-size:12px;">
                <!-- address -->
                <!-- 92 Impasse du Terraillet 73190 ST BALDOPH - Tél : +33 4 79 25 04 80 - Fax : +334 79 25 07 10 - info@domitec.net - www.domitec.net -->
                <!-- SARL au capital de 200 200 - N° Siret 42995752500042 - Code APE 4619B - N° TVA Intracom. FR 52 429 957 525 - RCS CHAMBERY 429 957 525 -->
                <span>
                <t t-if="company.street"> <span t-field="company.street" /> </t>
                <t t-if="company.zip"> <span t-field="company.zip" /> </t>
                <t t-if="company.city"> <span t-field="company.city" /> </t>
                -
                </span>

                <t t-if="company.phone"> <span> Tél : <span t-field="company.phone" /> - </span> </t>

                <!-- odoo ont supprimé le champ fax de res.company... parce que le fax en 2017 c'est trop has been tavu lol -->
                <span> Fax : +334 79 25 07 10 - </span>

                <t t-if="company.email"> <span> <span t-field="company.email" /> - </span> </t>
                <t t-if="company.website"> <span> <span t-field="company.website" /> </span> </t>

                <br/>

                <t t-if="company.report_footer"> <span> <span t-field="company.report_footer" /> - </span> </t>
                <t t-if="company.siret"> <span> N° Siret <span t-field="company.siret" /> - </span> </t>
                <t t-if="company.ape"> <span> Code APE <span t-field="company.ape" /> - </span> </t>
                <t t-if="company.vat"> <span> N° TVA Intracom. <span t-field="company.vat" /> - </span> </t>
                <span> RCS CHAMBERY 429 957 525 </span>
                <!--
                <li t-if="company.email"><i class="fa fa-at"/> <span t-field="company.email"/></li>
                <li t-if="company.website"><i class="fa fa-globe"/> <span t-field="company.website"/></li>
                <li t-if="company.vat"><i class="fa fa-building-o"/><t t-esc="company.country_id.vat_label or 'TIN'"/>: <span t-field="company.vat"/></li>
                -->

                <!-- images part -->
                <div class="row" style="margin-top:12px;">
                    <div class="col-xs-3 footer_logo">
                    <!-- <img src="/dom_reports/static/imgs/lithofin_logo.png" /> -->
                        <img t-if="market_info.fl1"
                            t-att-src="'data:image/png;base64,%s' % to_text(market_info.fl1)" />
                    </div>
                    <div class="col-xs-3 footer_logo">
                        <img t-if="market_info.fl2"
                            t-att-src="'data:image/png;base64,%s' % to_text(market_info.fl2)" />
                    </div>
                    <div class="col-xs-3 footer_logo">
                        <img t-if="market_info.fl3"
                            t-att-src="'data:image/png;base64,%s' % to_text(market_info.fl3)" />
                    </div>
                    <div class="col-xs-3 footer_logo">
                        <img t-if="market_info.fl4"
                            t-att-src="'data:image/png;base64,%s' % to_text(market_info.fl4)" />
                    </div>
                </div>
            </div> <!-- text center and font-size div -->
        </div> <!-- end of footer div -->

        <!--
        <div t-if="bl" class="footer">
            <p>footer</p>
        </div> -->

    </template>


    <template id="dom_reports.external_layout">

        <!-- in case of multicompany -->
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>

        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>

        <t t-call="dom_reports.external_layout_background">
            <t t-raw="0"/>
        </t>

    </template>

    <!-- other templates -->
    <template id="dom_reports.upper_part">

        <!-- pub / address -->
        <div class="row" style="margin-bottom: 10px; padding: 0 15px 0 15px;">

            <div t-if="not cf" class="col-xs-6">
                <div class="top-message-div">
                    <img t-if="market_info.top_message"
                     t-att-src="'data:image/png;base64,%s' % to_text(market_info.top_message)" />
                </div>
            </div>
            <div t-elif="cf" class="col-xs-6">
                <div class="top-message-div">
                    <span t-field="doc.company_id.horaires_livraison" />
                </div>
            </div>

            <!-- partner address -->
            <div class="col-xs-6 address-div">
                <div class="row">
                    <!--<span class="partner-name" t-field="doc.partner_id" /> <br/>-->

                    <!-- the address -->
                    <t t-if="bl">
                        <div t-field="doc.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,
                        &quot;fields&quot;: [&quot;address&quot;,'name'],
                        &quot;no_marker&quot;: True,
                        &quot;phone_icons&quot;: False}"/>
                    </t>
                    <t t-elif="cf">
                        <div t-field="doc.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,
                        &quot;fields&quot;: [&quot;address&quot;,'name'],
                        &quot;no_marker&quot;: True,
                        &quot;phone_icons&quot;: False}"/>
                    </t>
                    <t t-elif="devis or bdc or facture">
                        <t t-if="not doc.partner_shipping_id">
                        <!--
                            <span t-if="doc.partner_id.street" t-field="doc.partner_id.street" /> <br/>
                            <span t-if="doc.partner_id.street2" t-field="doc.partner_id.street2" /> <br/>
                            <span t-if="doc.partner_id.city" t-field="doc.partner_id.city" />
                            <span t-if="doc.partner_id.zip" t-field="doc.partner_id.zip" /> -->
                            <div t-field="doc.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,
                            &quot;fields&quot;: [&quot;address&quot;,'name'],
                            &quot;no_marker&quot;: True,
                            &quot;phone_icons&quot;: False}"/>
                        </t>
                        <t t-else="">
                            <div t-field="doc.partner_shipping_id" t-options="{&quot;widget&quot;: &quot;contact&quot;,
                            &quot;fields&quot;: [&quot;address&quot;,'name'],
                            &quot;no_marker&quot;: True,
                            &quot;phone_icons&quot;: False}"/>
                        </t>
                    </t>

                </div>

                <!-- Commercial / Vendeur -->
                <div t-if="devis or bdc" class="row">
                    <p style="text-align: right; margin:0px;"> Commercial : <span t-field="doc.user_id" /> </p>
                </div>
            </div>

        </div> <!-- end of pub/address row -->

        <!-- debug rows
        <div class="row">
            <p> facture : <span t-if="facture"> <t t-esc="facture" /> </span> </p>
            <p> devis : <span t-if="devis"> <t t-esc="devis" /> </span> </p>
            <p> bdc : <span t-if="bdc"> <t t-esc="bdc" /> </span> </p>
            <p> bl : <span t-if="bl"> <t t-esc="bl" /> </span> </p>
        </div>
        -->

        <!-- tried this.. not good
        <div t-if="devis or bdc" class="row" style="border: 1px solid black;">
            <div class="col-xs-12">
                <p> Commercial : <span t-field="doc.user_id" /> </p>
            </div>
        </div> -->

        <!-- bl warning row -->
        <div t-if="bl" class="row">
            <div class="col-xs-12">
                <p class="bl-warning">** Attention ! Merci de refuser toute marchandise abimée
                    et d'émettre les réserves sur le bordereau de transport. ** </p>
            </div>
        </div>

        <!-- mode de reglement / echeance / n/id cee -->
        <div class="row" style="margin-bottom: 12px;">
            <div class="col-xs-4">
                <table class="table-curved upper-part-table">
                    <thead>
                        <tr>
                            <th> MODE DE REGLEMENT </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <span t-if="not bl" t-field="doc.payment_term_id.note" />
                                <span t-elif="bl" t-field="doc.partner_id.property_payment_term_id.note" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-xs-4">
                <table class="table-curved upper-part-table">
                    <thead>
                        <tr>
                            <th t-if="devis"> Date de validité </th>
                            <th t-elif="bdc"> CONFIRMATION </th>
                            <th t-elif="facture"> ECHEANCE </th>
                            <th t-elif="bl"> Départ prévu le </th>
                            <th t-elif="cf"> DATE DE LIVRAISON </th>
                            <th t-else=""> ECHEANCE </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <!-- <td> <span t-field="doc.date_order" /> </td> -->
                                <!-- <p> echeance / depart val </p> -->
                                <!-- some are dates, some are datetimes... -->
                                <span t-if="devis" t-field="doc.validity_date" />
                                <span t-elif="bdc" t-field="doc.confirmation_date"
                                    t-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }"/>
                                <span t-elif="facture" t-field="doc.date_due" />
                                <span t-elif="bl" t-field="doc.scheduled_date"
                                    t-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }"/>
                                <span t-elif="cf" t-field="doc.date_planned"
                                    t-options="{ &quot;format&quot; : &quot;dd/MM/yyyy&quot; }"/>
                                <span t-else=""> </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-xs-4">
                <table class="table-curved upper-part-table vatnums-table">
                    <thead>
                        <tr>
                            <!-- <th> N/Id CEE :
                                <span t-field="doc.company_id.vat" />
                            </th> -->
                            <th t-if="not cf"> Ref. cde :
                                <span t-if="devis or bdc" t-field="doc.client_order_ref" />
                                <span t-if="facture" t-field="doc.name" />
                                <t t-if="bl">
                                    <span t-if="doc.sale_id" t-field="doc.sale_id.client_order_ref" />
                                    <span t-else="">aucune vente associée</span>
                                </t>
                            </th>
                            <th t-elif="cf"> N/Id CEE :
                                <span t-field="doc.company_id.vat" />
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td> V/Id CEE :
                                <span t-field="doc.partner_id.vat" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div> <!-- 3 tableaux row end -->
    </template>

</odoo>
