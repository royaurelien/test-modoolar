
<odoo>

    <template id="dom_report_bl_document">
        <t t-call="dom_reports.external_layout">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
            <div class="page">
                <div class="oe_structure"/>

                <t t-call="dom_reports.upper_part" />

                <table class="table-curved lines-table">
                    <thead>
                        <tr>
                            <th>REFERENCE</th>
                            <th>DESIGNATION</th>
                            <th>QTE</th>
                            <!--<th>CONDT</th>-->
                            <th>POIDS</th>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                        <tr t-foreach="doc.move_lines" t-as="move">
                            <td> <span t-field="move.product_id.default_code"/> </td>
                            <td> <span t-field="move.product_id.name"/> </td>
                            <td>
                                <span t-field="move.quantity_done"/> <span t-field="move.product_uom"/>
                            </td>
                            <!--<td>
                                <span t-field="move.product_uom"/>
                            </td>-->
                            <td> <span t-esc="(move.product_id.weight * move.quantity_done)"/> </td>
                        </tr>
                    </tbody>
                </table>

                <div class="row">
                    <div class="col-xs-6">
                        Remarque :
                    </div>

                    <div class="col-xs-6">
                        NB LIVRAISON :
                    </div>
                </div>

                <div class="bl-spacer-div"></div>

                <!-- summary table -->
                <div class="row bl-summary-line">
                    <t t-set="err_mess">
                       <p> Odoo n'est pas configuré pour la gestion des colis. </p>
                    </t>
                    <div class="col-xs-4">
                        <!--<p> Nombre de carton : <span t-field="doc.number_of_packages"/> </p>-->
                        <t t-if=" 'package_ids' in doc.fields_get() ">
                            <p> Nombre de carton : <span t-esc="len(doc.package_ids.ids)"/> </p>
                        </t>
                        <t t-else="">
                            <t t-raw="err_mess" /> <p>(champ package_ids inexistant)</p>
                        </t>
                        <!--<p> Nombre de carton : <span t-field="doc.package_ids"/> </p>-->
                    </div>
                    <div class="col-xs-4">
                        <p> Total Quantité : <span t-esc="'%.2f'%(sum([x.quantity_done for x in doc.move_lines]))"/> </p>
                    </div>
                    <div class="col-xs-4">
                        <t t-if=" 'shipping_weight' in doc.fields_get() ">
                            <p> Total Poids Brut : <span t-field="doc.shipping_weight"/> <span t-field="doc.weight_uom_id"/> </p>
                        </t>
                        <t t-else="">
                            <t t-raw="err_mess" /> <p>(champ shipping_weight inexistant)</p>
                        </t>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12">
                        <p class="invoice-warning-two">
La présente vente est conclue en application des conditions générales de vente figurant au verso du document
                        </p>
                    </div>
                </div>

            </div>
        </t>
    </template>

    <template id="dom_report_bl">
        <t t-call="web.html_container">
            <t t-set="bl" t-value="True"/>
            <t t-foreach="docs" t-as="doc">
                <t t-call="dom_reports.dom_report_bl_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>

</odoo>
